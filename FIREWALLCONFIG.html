#define CROW_MAIN
#include "crow_all.h"

int main() {
    crow::SimpleApp app;

    CROW_ROUTE(app, "/")([](){
        return R"(
<!DOCTYPE html>
<html>
<head>
    <title>UFW Firewall Configuration Guide</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 30px; line-height: 1.7; color: #333; }
        h1 { color: #2c5282; text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        h2 { color: #2d3748; border-left: 4px solid #4299e1; padding-left: 15px; }
        .step { background: #f7fafc; margin: 20px 0; padding: 20px; border-radius: 8px; border-left: 4px solid #48bb78; }
        code { background: #2d3748; color: #a0aec0; padding: 2px 6px; border-radius: 3px; font-family: 'Courier New', monospace; }
        pre { background: #2d3748; color: #a0aec0; padding: 15px; border-radius: 5px; overflow-x: auto; }
        .warning { background: #fed7d7; border-left: 4px solid #e53e3e; padding: 15px; margin: 20px 0; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; }
        th { background: #4299e1; color: white; }
    </style>
</head>
<body>
    <h1>üîí Basic UFW Firewall Configuration</h1>
    
    <div class="warning">
        <strong>‚ö†Ô∏è CRITICAL:</strong> Always allow SSH <strong>BEFORE</strong> enabling UFW or you'll lose remote access!
    </div>

    <div class="step">
        <h2>Step 1: Install UFW</h2>
        <pre><code>sudo apt update
sudo apt install ufw</code></pre>
        <p>UFW is available in most Linux distributions' repositories (Ubuntu, Debian, Mint).</p>
    </div>

    <div class="step">
        <h2>Step 2: Set Default Policies</h2>
        <pre><code>sudo ufw default deny incoming
sudo ufw default allow outgoing</code></pre>
        <p>Deny all incoming, allow all outgoing (standard server hardening).</p>
    </div>

    <div class="step">
        <h2>Step 3: Allow SSH (Port 22)</h2>
        <pre><code>sudo ufw allow ssh
# OR specifically:
sudo ufw allow 22/tcp</code></pre>
    </div>

    <div class="step">
        <h2>Step 4: Deny HTTP (Port 80)</h2>
        <pre><code>sudo ufw deny http
# OR specifically:
sudo ufw deny 80/tcp</code></pre>
        <p>Explicitly block web traffic while allowing SSH.</p>
    </div>

    <div class="step">
        <h2>Step 5: Enable Firewall</h2>
        <pre><code>sudo ufw --force enable</code></pre>
        <p><strong>Output:</strong> "Firewall is active and enabled on system startup"</p>
    </div>

    <div class="step">
        <h2>Step 6: Verify Rules</h2>
        <pre><code>sudo ufw status verbose</code></pre>
        <p><strong>Expected Output:</strong></p>
        <pre><code>Status: active
Logging: on (low)
Default: deny (incoming), allow (outgoing), disabled (routed)

To                         Action      From
--                         ------      ----
22/tcp (SSH)              ALLOW IN    Anywhere
80/tcp (HTTP)             DENY IN     Anywhere</code></pre>
    </div>

    <h2>Quick Reference Commands</h2>
    <table>
        <tr><th>Action</th><th>Command</th></tr>
        <tr><td>Check Status</td><td><code>sudo ufw status verbose</code></td></tr>
        <tr><td>Disable</td><td><code>sudo ufw disable</code></td></tr>
        <tr><td>Reset All</td><td><code>sudo ufw reset</code></td></tr>
        <tr><td>Allow Port</td><td><code>sudo ufw allow 443/tcp</code></td></tr>
        <tr><td>Delete Rule</td><td><code>sudo ufw delete deny 80</code></td></tr>
    </table>

    <h2>Production Tips</h2>
    <ul>
        <li>Always test SSH after changes: <code>ssh user@yourserver</code></li>
        <li>Use service names: <code>ufw allow http</code> (resolves to port 80)</li>
        <li>Enable logging: <code>sudo ufw logging on</code></li>
        <li>IPv6: Edit <code>/etc/default/ufw</code> and set <code>IPV6=yes</code></li>
    </ul>

    <p style="text-align: center; font-style: italic; color: #666; margin-top: 40px;">
        Secure your Linux server in 2 minutes with UFW!
    </p>
</body>
</html>
        )";
    });

    app.port(8080).multithreaded().run();
}